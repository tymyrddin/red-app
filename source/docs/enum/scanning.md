# What to look for

## XSS

To detect most of the vulnerabilities in web applications, the basic tool to detect, analyze, and exploit them, is an HTTP proxy like Zap or Burp to analyse each HTTP request made by the application. And field by field, modify the content with some basic testing strings.

## CSRF

To detect CSRF flaws in an application, it is important to navigate through the entire application, trying to map all the called methods to identify which are important due to the kind of processing it has. Find out how they are called, which parameters are sent to the application, if there is any anti-CSRF protection, and if it is one of the vulnerable protections we saw before. Also, if protected, try to find an error. The information needed to exploit the vulnerability could be in another application's request.

## Open redirects

There are some redirections that are easy to detect â€“ most redirections use a GET request. Others are a little more difficult to detect in simple view and need the use of the HTTP proxy to confirm them.

## XXE

If it's possible, download an XML document generated by the application so you know the structure. If not possible, create a simple template which can be modified to discover its structure.

* See if it's possible to add a reference to a resource; a good trick that's commonly used by attackers is to generate a reverse response that could be captured in a server where we have control
* If it's not possible to add an external reference, but you receive an error, modify the request and submit tags. If the error disappears, it means that the parser is accepting the tags as valid, so it might be vulnerable.
* You can also try entering data before or in the middle of the tags, as it needs to be valid for the parser, and sometimes the parser is waiting for a value. If this continues without any errors, try to create a reference to a resource, internal or external, and look at the result.

## SSTI

SSTIs can appear in two contexts:

* Plaintext: It is possible to directly input HTML into the application, for example, in a text editor. 
* Code: Values entered are processed by the application and return a result. Usually these kind result in XSS attacks, due to the evaluated input, so, if you enter an `alert()` function, it will be shown.

Once you detect that there's SSTI, using an invalid input and getting a result, try to determine which template engine is used, because although all of them working in similar ways, they have important differences:

| ![Engines](../../_static/images/ssti-engines.png) |
|:--:|
| Based on the input and by following it, you can determine which is the engine used by the<br> application in some cases. |

## Resources

* [Zaproxy on Kali](red-iac:docs/lab/zap)
* [ZAP Getting Started](https://www.zaproxy.org/getting-started/)
* [ZAP Baseline scan](https://www.zaproxy.org/docs/docker/baseline-scan/)
* [ZAP Full scan](https://www.zaproxy.org/docs/docker/full-scan/)
